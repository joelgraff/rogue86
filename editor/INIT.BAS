2 PRINT "INPUT.BAS"
3 MERGE "INPUT.BAS"
500 '------------------
510 '--Initialization--
520 '------------------
521 SCREEN 0,0
522 CLS
523 KEY OFF
524 DEFINT A-Z
525 TRUE = -1
526 FALSE = 0
527 QUIT.LOOP = FALSE
528 KEY.PRESS = 0
529 VERSION$ = "1.0"
530 PAGE.CURRENT = &HB80A
531 PAGE.LENGTH = 3840
532 PAGE.INDEX = 0
533 PAGE.ROW = 12
534 PAGE.COL = 39
535 PAUSE.TIME = 3
540 ATTR.BLINK = 0
541 ATTR.INTENSE = 0
542 ATTR.FORE = 7
543 ATTR.BACK = 0
544 ATTR.CURRENT = 7
545 ATTR.INVERT = 247
546 ATTR.DELTA = 0
550 OFFSET.CURRENT = 1998
551 OFFSET.DELTA = 0
552 STAT.POSITION$ = STR$(PAGE.ROW)+","+STR$(PAGE.COL)
560 DIM KEYPAD.MAP(5,256)
561 DIM CHAR.BUFFER(160)
562 KEYPAD.MODE = 0
563 CHAR.COUNT = 0
564 DIM KEYBOARD.MAP(360)
565 DIM CMD.MAP(512)
600 '-- DRAW FLAGS --
601 FLAG.REDRAW.CLEAR = TRUE
602 FLAG.REDRAW.STAT = TRUE
604 FLAG.REDRAW.CRSR = FALSE
606 FLAG.RESET.CRSR = TRUE
608 FLAG.REDRAW.ATTR = FALSE
610 FLAG.REFRESH.CRSR = FALSE
612 FLAG.RECALC.ATTR = FALSE
614 CMD.MOV = 1
616 CMD.ATR = 2
618 CMD.KBD = 4
620 CMD.KPD = 8
622 CMD.MOV.LT = CMD.MOV OR 16 : CMD.MAP(65) = CMD.MOV.LT
624 CMD.MOV.RT = CMD.MOV OR 32 : CMD.MAP(68) = CMD.MOV.RT
626 CMD.MOV.UP = CMD.MOV OR 64 : CMD.MAP(87) = CMD.MOV.UP
628 CMD.MOV.DN = CMD.MOV OR 128 : CMD.MAP(83) = CMD.MOV.DN
630 CMD.MOV.ROW.LT = CMD.MOV OR 48 : CMD.MAP(81) = CMD.MOV.ROW.LT
632 CMD.MOV.ROW.RT = CMD.MOV OR 80 : CMD.MAP(69) = CMD.MOV.ROW.RT
634 CMD.MOV.COL.TOP = CMD.MOV OR 96 : CMD.MAP(82) = CMD.MOV.COL.TOP
636 CMD.MOV.COL.BOT = CMD.MOV OR 160 : CMD.MAP(70) = CMD.MOV.COL.BOT
638 CMD.MOV.PG.UP = CMD.MOV OR 112 : CMD.MAP(67) = CMD.MOV.PG.UP
640 CMD.MOV.PG.DN = CMD.MOV OR 176 : CMD.MAP(90) = CMD.MOV.PG.DN
642 CMD.ATR.FC.UP = CMD.ATR OR 16 : CMD.MAP(362) = CMD.ATR.FC.UP
644 CMD.ATR.FC.DN = CMD.ATR OR 32 : CMD.MAP(363) = CMD.ATR.FC.DN
646 CMD.ATR.BC.UP = CMD.ATR OR 64 : CMD.MAP(351) = CMD.ATR.BC.UP
648 CMD.ATR.BC.DN = CMD.ATR OR 128 : CMD.MAP(359) = CMD.ATR.BC.DN
650 CMD.ATR.BL = CMD.ATR OR 48 : CMD.MAP(353) = CMD.ATR.BL
652 CMD.ATR.HI = CMD.ATR OR 80 : CMD.MAP(361) = CMD.ATR.HI
654 CMD.ATR.SET = CMD.ATR OR 144 : CMD.MAP(86) = CMD.ATR.SET
656 CMD.MAP(88) = CMD.KBD
658 CMD.KBD.DEL = CMD.KBD OR 16 : CMD.MAP(8) = CMD.KBD.DEL
660 CMD.KBD.SAVE = CMD.KBD OR 32 : CMD.MAP(19) = CMD.KBD.SAVE
662 CMD.KBD.LOAD = CMD.KBD OR 64 : CMD.MAP(12) = CMD.KBD.LOAD
663 CMD.ATR.DUP = CMD.ATR OR 96 : CMD.MAP(4) = CMD.ATR.DUP
664 CMD.KBD.QUIT = CMD.KBD OR 128 : CMD.MAP(17) = CMD.KBD.QUIT
665 CMD.KBD.CLEAR = CMD.KBD OR 48 : CMD.MAP(3) = CMD.KBD.CLEAR
666 CMD.KPD.MOD = CMD.KPD : CMD.MAP(366) = CMD.KPD
668 CMD.KPD.CTR = CMD.KPD OR 64 : CMD.MAP(276) = CMD.KPD.CTR
670 CMD.KPD.H = CMD.KPD OR 196 : CMD.MAP(282) = CMD.KPD.H
672 CMD.KPD.V = CMD.KPD OR 128 : CMD.MAP(283) = CMD.KPD.V
674 CMD.KPD.TEE.LT = CMD.KPD OR 32 : CMD.MAP(275) = CMD.KPD.TEE.LT
676 CMD.KPD.TEE.RT = CMD.KPD OR 96 : CMD.MAP(277) = CMD.KPD.TEE.RT
678 CMD.KPD.TEE.UP = CMD.KPD OR 160 : CMD.MAP(272) = CMD.KPD.TEE.UP
680 CMD.KPD.TEE.DN = CMD.KPD OR 224 : CMD.MAP(280) = CMD.KPD.TEE.DN
682 CMD.KPD.COR.UL = CMD.KPD OR 16 : CMD.MAP(271) = CMD.KPD.COR.UL
684 CMD.KPD.COR.UR = CMD.KPD OR 48 : CMD.MAP(273) = CMD.KPD.COR.UR
686 CMD.KPD.COR.LL = CMD.KPD OR 112 : CMD.MAP(279) = CMD.KPD.COR.LL
688 CMD.KPD.COR.LR = CMD.KPD OR 240 : CMD.MAP(281) = CMD.KPD.COR.LR
800 '---- single/single map ---
801 FOR X = 1 TO 11
802   READ SCANCODE, MAPCODE
804   KEYPAD.MAP(0,SCANCODE) = MAPCODE
806 NEXT
810 DATA 79,192,80,193,81,217,75,195,76,197,77,180,71,218,72,194,73,191,82,196
812 DATA 83,179
813 '---- double/single map ---
814 FOR X = 1 TO 11
816   READ SCANCODE, MAPCODE
818   KEYPAD.MAP(1, SCANCODE) = MAPCODE
820 NEXT
824 DATA 79,211,80,208,81,189,75,199,76,215,77,182,71,214,72,210,73,183,82,196
826 DATA 83,186
827 '--- single/double map ---
828 FOR X = 1 TO 11
830   READ SCANCODE, MAPCODE
832   KEYPAD.MAP(2, SCANCODE) = MAPCODE
834 NEXT
838 DATA 79,212,80,207,81,190,75,198,76,216,77,181,71,213,72,209,73,184,82,205
840 DATA 83, 179
841 '--- double/double map ---
842 FOR X = 1 TO 11
844   READ SCANCODE, MAPCODE
846   KEYPAD.MAP(3, SCANCODE) = MAPCODE
848 NEXT
852 DATA 79,200,80,202,81,188,75,204,76,206,77,185,71,201,72,203,73,187,82,205
854 DATA 83, 186
856 '--- keyboard map ---
858 FOR X = 1 TO 28
860   READ ASCCODE, MAPCODE
862   KEYBOARD.MAP(ASCCODE) = MAPCODE
864 NEXT
866 DATA 66,176,78,177,77,178,71,248,72,249,74,250,75,174,76,175
867 DATA 84,29,89,12,85,23,73,28,79,169,80,170
868 DATA 48,15,49,1,50,2,51,3,52,4,53,5,54,6,55,8,56,9,57,10
869 DATA 352,24,355,27,360,25,357,26
870 '--- DIRECT MAPPINGS ---
885 FOR Y = 1 TO 4
886   READ A,B
887   FOR X = A TO B
888     KEYBOARD.MAP(X) = X
889   NEXT X
890 NEXT Y
891 DATA 33,47,58,64,91,96,123,126
900 '--- keypad blocks ---
910 FOR X = 1 TO 11
920   READ SCANCODE, MAPCODE
930   KEYPAD.MAP(4, SCANCODE) = MAPCODE
940 NEXT
950 DATA 79,16,80,223,81,17,75,222,76,219,77,221,71,30,72,220,73,031,82,254
960 DATA 83, 22
970 POKE OFFSET.CURRENT + 1, PEEK(OFFSET.CURRENT + 1) XOR ATTR.INVERT
980 FLAG.REDRAW.STAT = TRUE
990 FLAG.RESET.CRSR = TRUE
1000 RETURN
